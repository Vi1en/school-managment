import{j as e}from"./ui-aae23e34.js";import{r as m}from"./vendor-280e31ee.js";import{u as G,a as A,I as n,B as j,v as l,b as E}from"./index-0b20c233.js";import{a as B}from"./router-b40667b9.js";const T=()=>{const f=B(),{createStudent:C}=G(),{setError:k,clearError:P}=A(),[b,N]=m.useState(!1),[x,u]=m.useState(""),[F,y]=m.useState(null),[p,q]=m.useState(null),[r,g]=m.useState({admissionNumber:"",studentName:"",fatherName:"",motherName:"",dob:"",address:"",phoneNumber:"",currentClass:"",bloodGroup:"",feeDetails:{totalFee:0,amountPaid:0}}),[s,v]=m.useState({}),i=t=>{const{name:a,value:o,type:c}=t.target;if(a.startsWith("feeDetails.")){const d=a.split(".")[1];g(h=>({...h,feeDetails:{...h.feeDetails,[d]:c==="number"?o===""?0:parseFloat(o):o}}))}else g(d=>({...d,[a]:c==="number"?o===""?0:parseFloat(o):o}));s[a]&&v(d=>({...d,[a]:""}))},D=t=>{var o;const a=(o=t.target.files)==null?void 0:o[0];if(a){if(!a.type.startsWith("image/")){u("Please select an image file (JPG, PNG, JPEG)");return}if(a.size>2*1024*1024){u("File size must be less than 2MB");return}y(a),u("");const c=new FileReader;c.onload=d=>{var h;q((h=d.target)==null?void 0:h.result)},c.readAsDataURL(a)}},S=()=>{const t={};return l(r.admissionNumber)||(t.admissionNumber="Admission Number is required"),l(r.studentName)||(t.studentName="Student Name is required"),l(r.fatherName)||(t.fatherName="Father Name is required"),l(r.motherName)||(t.motherName="Mother Name is required"),l(r.dob)||(t.dob="Date of Birth is required"),l(r.currentClass)||(t.currentClass="Current Class is required"),l(r.bloodGroup)||(t.bloodGroup="Blood Group is required"),l(r.address)||(t.address="Address is required"),l(r.phoneNumber)?E(r.phoneNumber)||(t.phoneNumber="Please enter a valid phone number"):t.phoneNumber="Phone Number is required",r.feeDetails.totalFee<=0&&(t.totalFee="Total Fee must be greater than 0"),r.feeDetails.amountPaid<0&&(t.amountPaid="Amount Paid cannot be negative"),r.feeDetails.amountPaid>r.feeDetails.totalFee&&(t.amountPaid="Amount Paid cannot be greater than Total Fee"),v(t),Object.keys(t).length===0},w=async t=>{if(t.preventDefault(),!!S()){N(!0),u(""),P();try{const a={...r,photo:F||void 0},o=await C(a);o.success?f("/students"):u(o.error||"Failed to create student")}catch(a){u(a.message||"Failed to create student")}finally{N(!1)}}};return e.jsx("div",{className:"max-w-4xl mx-auto space-y-6",children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Add New Student"}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(n,{label:"Admission Number *",name:"admissionNumber",value:r.admissionNumber,onChange:i,error:s.admissionNumber,required:!0}),e.jsx(n,{label:"Student Name *",name:"studentName",value:r.studentName,onChange:i,error:s.studentName,required:!0}),e.jsx(n,{label:"Father Name *",name:"fatherName",value:r.fatherName,onChange:i,error:s.fatherName,required:!0}),e.jsx(n,{label:"Mother Name *",name:"motherName",value:r.motherName,onChange:i,error:s.motherName,required:!0}),e.jsx(n,{label:"Date of Birth *",name:"dob",type:"date",value:r.dob,onChange:i,error:s.dob,required:!0}),e.jsx(n,{label:"Current Class *",name:"currentClass",value:r.currentClass,onChange:i,error:s.currentClass,required:!0}),e.jsx(n,{label:"Blood Group *",name:"bloodGroup",value:r.bloodGroup,onChange:i,error:s.bloodGroup,required:!0}),e.jsx(n,{label:"Phone Number *",name:"phoneNumber",value:r.phoneNumber,onChange:i,error:s.phoneNumber,required:!0})]}),e.jsx("div",{children:e.jsx(n,{label:"Address *",name:"address",value:r.address,onChange:i,error:s.address,required:!0})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student Photo"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:D,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),p&&e.jsx("img",{src:p,alt:"Preview",className:"h-20 w-20 object-cover rounded-lg"})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Fee Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(n,{label:"Total Fee *",name:"feeDetails.totalFee",type:"number",min:"0",value:r.feeDetails.totalFee,onChange:i,error:s.totalFee,required:!0}),e.jsx(n,{label:"Amount Paid *",name:"feeDetails.amountPaid",type:"number",min:"0",value:r.feeDetails.amountPaid,onChange:i,error:s.amountPaid,required:!0})]})]}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:x})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(j,{type:"button",variant:"secondary",onClick:()=>f("/students"),children:"Cancel"}),e.jsx(j,{type:"submit",variant:"primary",loading:b,disabled:b,children:b?"Creating...":"Create Student"})]})]})]})})};export{T as default};
